import{C as e,o as t,D as a,F as l,b as s,E as i,G as n}from"./elementPlus-dc9fb5e5.js";import{u as o,t as r,_ as d}from"./index-01a19521.js";import{ae as u,A as c,v as f,a8 as m,o as p,j as v,a4 as h,_ as y,u as g,k as _,a2 as b,Z as x,bn as S,W as z,bt as $,bu as w}from"./vendor-ca0d1403.js";const T=o(),M=["紧急不重要","重要且紧急","不重要不紧急","重要不紧急"],k=[];let E=Array(4).fill(0);E.map(((e,t)=>{E[t]={name:M[t],value:0}}));const D=(()=>{const e=[0,0,0,0];return T.todayData.forEach((t=>{e[t.type]++})),E.forEach(((t,a)=>{e[a]>0&&(t.value=e[a])})),E=E.filter((e=>{if(e.value>0)return k.push(e.name),!0})),E})();T.$onAction((e=>{"pushStore"===e.name&&u((()=>{const t=e.args[0].type;D[t]||(D[t]={name:M[t],value:0},k.push(M[t])),D[t].value++,j.setOption({series:[{name:"count",data:D}],legend:[{data:k,id:1}]})}))}));const A=[],L=[];T.todayData.forEach((e=>{e.focusTime>0&&(L.push({name:e.description,value:e.focusTime}),A.push(e.description))})),T.$onAction((e=>{"updateStoreTime"===e.name&&u((()=>{const t=e.args[0].value,a=L.findIndex((e=>e.name===t.description));-1===a?(L.push({name:t.description,value:t.focusTime+e.args[1]}),A.push(t.description)):L[a].value+=e.args[1],j.setOption({series:[{name:"focus",data:L}],legend:[{data:A,id:2}]})}))}));let j=null;const I=o();let O=c(0),H=c(0);I.todayData.length&&I.todayData.forEach((e=>{e.focusTime>0&&(H.value+=e.focusTime,O.value+=e.focusTimes)}));let W=c(0),C=c(0),B=c(0);indexedDB.open("PlanDB",5).onsuccess=function(e){e.target.result.transaction("record","readonly").objectStore("record").getAll().onsuccess=function(e){const t=e.target.result;if(!t.length)return;const a=new Set;t.forEach((e=>{e.focusTime&&(W.value+=e.focusTimes,C.value+=e.focusTime,a.add(e.date))})),B.value=a.size}},I.$onAction((e=>{"updateStoreTime"===e.name&&u((()=>{H.value+=e.args[1],O.value+=1,W.value+=1,C.value+=e.args[1],localStorage.getItem(r)||(B.value+=1,localStorage.setItem(r,`${B.value}`))}))}));const G=e=>($("data-v-cd673ac2"),e=e(),w(),e),P={style:{display:"inline-flex","align-items":"center","font-size":"2rem"}},F={style:{display:"inline-flex","align-items":"center","font-size":"2rem"}},U=G((()=>_("div",{style:{display:"inline-flex","align-items":"center","font-size":"2rem"}}," 总专注天数 ",-1))),V={class:"today_statistic"},Z=G((()=>_("p",null,"今日数据",-1))),q=G((()=>_("div",{style:{display:"inline-flex","align-items":"center","font-size":"2rem","padding-bottom":"1vh"}}," 今日专注时长 ",-1))),J=G((()=>_("div",{style:{display:"inline-flex","align-items":"center","font-size":"2rem","padding-bottom":"1vh"}}," 专注次数 ",-1))),K={class:"barGraph"},N=G((()=>_("div",{class:"divider"},null,-1))),Q=G((()=>_("p",null,"今日计划情况",-1))),R=d({__name:"statistic",setup(o){const r=c();function d(e){let t=`${e}`.padStart(2,"0")+"秒",a=e;return a>=3600?t=`${Math.floor(a/3600)}时${Math.floor(Math.floor(a%3600)/60)}分${Math.floor(a%60)}秒`:a>=60&&(t=`${Math.floor(a/60)}分${a%60}秒`),t}return f((()=>{var e;e=r.value,j=echarts.init(e,null),window.addEventListener("resize",(()=>{j.resize()}),{passive:!0}),j.setOption({lazyUpdate:!0,title:[{text:"[计划优先级分布]",textStyle:{fontSize:"1.5rem"}},{textStyle:{fontSize:"1.5rem"},text:"[专注时长分布]",top:"50%"}],color:["yellow","pink","skyblue","greenyellow"],legend:[{id:1,data:k,top:"5%",orient:"vertical",left:"3%",itemWidth:10,itemHeight:10,itemStyle:{borderWidth:0},selectedMode:!1,textStyle:{fontSize:"1.3rem"}},{id:2,orient:"vertical",type:"scroll",top:"56%",left:"0",textStyle:{fontSize:"1.5rem"},itemWidth:10,itemHeight:10,data:A}],series:[{type:"pie",radius:["25%","33%"],center:["53%","24%"],top:-10,avoidLabelOverlap:!0,showEmptyCircle:!0,labelLine:{length:"10",length2:"15",align:"center"},label:{formatter:function(e){return 0===e.data.value?"":`${e.data.value}条\n${e.data.name}`},overflow:"breakAll",alignTo:"labelLine",edgeDistance:"10%"},name:"count",data:D,legendHoverLink:!1,emphasis:{scale:!1}},{type:"pie",name:"focus",data:L,legendHoverLink:!1,avoidLabelOverlap:!0,showEmptyCircle:!0,center:["52%","73%"],radius:["25%","33%"],label:{formatter:function(e){let t=e.data.value;if(0===t)return"";let a=t+"秒";return t>=3600?a=`${Math.floor(t/3600)}时${Math.floor(Math.floor(t%3600)/60)}分${Math.floor(t%60)}秒`:t>=60&&(a=`${Math.floor(t/60)}分${t%60}秒`),a+"\n"+e.data.name}},emphasis:{scale:!1}}]})})),m((()=>{j.dispose()})),(o,u)=>{const c=t,f=a,m=l,$=s,w=i,T=n;return p(),v("div",{class:"wrapper",style:z({borderImageSource:"url("+g("/assets/img_6-f73fbd91.webp")+")"})},[h(w,{class:"total"},{default:y((()=>[h($,{span:8},{default:y((()=>[h(m,{value:g(W)},{title:y((()=>[_("div",P,[b(" 专注总次数 "),h(f,{effect:"dark",content:"我专注了的次数",placement:"top"},{default:y((()=>[h(c,{style:{"margin-left":"1vw"},size:"3.5vw"},{default:y((()=>[h(g(e))])),_:1},8,["size"])])),_:1})])])),suffix:y((()=>[b("次")])),_:1},8,["value"])])),_:1}),h($,{span:8},{default:y((()=>[h(m,{value:g(C),formatter:d},{title:y((()=>[_("div",F,[b(" 专注总时长 "),h(f,{effect:"dark",content:"我所有专注记录的总时长",placement:"top"},{default:y((()=>[h(c,{style:{"margin-left":"1vw"},size:"3.5vw"},{default:y((()=>[h(g(e))])),_:1},8,["size"])])),_:1})])])),_:1},8,["value"])])),_:1}),h($,{span:8},{default:y((()=>[h(m,{value:g(B)},{title:y((()=>[U])),suffix:y((()=>[b("天")])),_:1},8,["value"])])),_:1})])),_:1}),_("div",V,[Z,h(T,{"border-style":"dashed"}),h(w,null,{default:y((()=>[h($,{span:12},{default:y((()=>[h(m,{value:g(H),formatter:d},{title:y((()=>[q])),_:1},8,["value"])])),_:1}),h($,{span:12},{default:y((()=>[h(m,{value:g(O)},{title:y((()=>[J])),suffix:y((()=>[b("次")])),_:1},8,["value"])])),_:1})])),_:1})]),_("div",K,[N,Q,h(T,{"border-style":"dashed"}),(p(),x(S,null,[_("div",{class:"pie",ref_key:"pie",ref:r,style:{width:"100%",height:"56vh"}},null,512)],1024))])],4)}}},[["__scopeId","data-v-cd673ac2"]]),X={__name:"fourthView",setup:e=>(e,t)=>(p(),x(R))};export{X as default};
