import{C as e,o as t,D as a,F as l,b as s,E as i,G as n}from"./elementPlus-7bd05a90.js";import{u as o,t as r,_ as d}from"./index-f8180e1d.js";import{ae as u,A as c,v as f,a8 as m,o as p,j as v,a4 as h,_ as y,u as g,k as _,a2 as b,Z as x,bo as S,W as w,bt as z,bu as $}from"./vendor-d4830297.js";const T=""+new URL("img_6-f73fbd91.webp",import.meta.url).href,M=o(),k=["紧急不重要","重要且紧急","不重要不紧急","重要不紧急"],E=[];let D=Array(4).fill(0);D.map(((e,t)=>{D[t]={name:k[t],value:0}}));const L=(()=>{const e=[0,0,0,0];return M.todayData.forEach((t=>{e[t.type]++})),D.forEach(((t,a)=>{e[a]>0&&(t.value=e[a])})),D=D.filter((e=>{if(e.value>0)return E.push(e.name),!0})),D})();M.$onAction((e=>{"pushStore"===e.name&&u((()=>{const t=e.args[0].type;L[t]||(L[t]={name:k[t],value:0},E.push(k[t])),L[t].value++,I.setOption({series:[{name:"count",data:L}],legend:[{data:E,id:1}]})}))}));const A=[],j=[];M.todayData.forEach((e=>{e.focusTime>0&&(j.push({name:e.description,value:e.focusTime}),A.push(e.description))})),M.$onAction((e=>{"updateStoreTime"===e.name&&u((()=>{const t=e.args[0].value,a=j.findIndex((e=>e.name===t.description));-1===a?(j.push({name:t.description,value:t.focusTime+e.args[1]}),A.push(t.description)):j[a].value+=e.args[1],I.setOption({series:[{name:"focus",data:j}],legend:[{data:A,id:2}]})}))}));let I=null;const O=o();let H=c(0),W=c(0);O.todayData.length&&O.todayData.forEach((e=>{e.focusTime>0&&(W.value+=e.focusTime,H.value+=e.focusTimes)}));let C=c(0),B=c(0),G=c(0);indexedDB.open("PlanDB",5).onsuccess=function(e){e.target.result.transaction("record","readonly").objectStore("record").getAll().onsuccess=function(e){const t=e.target.result;if(!t.length)return;const a=new Set;t.forEach((e=>{e.focusTime&&(C.value+=e.focusTimes,B.value+=e.focusTime,a.add(e.date))})),G.value=a.size}},O.$onAction((e=>{"updateStoreTime"===e.name&&u((()=>{W.value+=e.args[1],H.value+=1,C.value+=1,B.value+=e.args[1],localStorage.getItem(r)||(G.value+=1,localStorage.setItem(r,`${G.value}`))}))}));const P=e=>(z("data-v-cd673ac2"),e=e(),$(),e),U={style:{display:"inline-flex","align-items":"center","font-size":"2rem"}},F={style:{display:"inline-flex","align-items":"center","font-size":"2rem"}},R=P((()=>_("div",{style:{display:"inline-flex","align-items":"center","font-size":"2rem"}}," 总专注天数 ",-1))),V={class:"today_statistic"},Z=P((()=>_("p",null,"今日数据",-1))),q=P((()=>_("div",{style:{display:"inline-flex","align-items":"center","font-size":"2rem","padding-bottom":"1vh"}}," 今日专注时长 ",-1))),J=P((()=>_("div",{style:{display:"inline-flex","align-items":"center","font-size":"2rem","padding-bottom":"1vh"}}," 专注次数 ",-1))),K={class:"barGraph"},N=P((()=>_("div",{class:"divider"},null,-1))),Q=P((()=>_("p",null,"今日计划情况",-1))),X=d({__name:"statistic",setup(o){const r=c();function d(e){let t=`${e}`.padStart(2,"0")+"秒",a=e;return a>=3600?t=`${Math.floor(a/3600)}时${Math.floor(Math.floor(a%3600)/60)}分${Math.floor(a%60)}秒`:a>=60&&(t=`${Math.floor(a/60)}分${a%60}秒`),t}return f((()=>{var e;e=r.value,I=echarts.init(e,null),window.addEventListener("resize",(()=>{I.resize()}),{passive:!0}),I.setOption({lazyUpdate:!0,title:[{text:"[计划优先级分布]",textStyle:{fontSize:"1.5rem"}},{textStyle:{fontSize:"1.5rem"},text:"[专注时长分布]",top:"50%"}],color:["yellow","pink","skyblue","greenyellow"],legend:[{id:1,data:E,top:"5%",orient:"vertical",left:"3%",itemWidth:10,itemHeight:10,itemStyle:{borderWidth:0},selectedMode:!1,textStyle:{fontSize:"1.3rem"}},{id:2,orient:"vertical",type:"scroll",top:"56%",left:"0",textStyle:{fontSize:"1.5rem"},itemWidth:10,itemHeight:10,data:A}],series:[{type:"pie",radius:["25%","33%"],center:["53%","24%"],top:-10,avoidLabelOverlap:!0,showEmptyCircle:!0,labelLine:{length:"10",length2:"15",align:"center"},label:{formatter:function(e){return 0===e.data.value?"":`${e.data.value}条\n${e.data.name}`},overflow:"breakAll",alignTo:"labelLine",edgeDistance:"10%"},name:"count",data:L,legendHoverLink:!1,emphasis:{scale:!1}},{type:"pie",name:"focus",data:j,legendHoverLink:!1,avoidLabelOverlap:!0,showEmptyCircle:!0,center:["52%","73%"],radius:["25%","33%"],label:{formatter:function(e){let t=e.data.value;if(0===t)return"";let a=t+"秒";return t>=3600?a=`${Math.floor(t/3600)}时${Math.floor(Math.floor(t%3600)/60)}分${Math.floor(t%60)}秒`:t>=60&&(a=`${Math.floor(t/60)}分${t%60}秒`),a+"\n"+e.data.name}},emphasis:{scale:!1}}]})})),m((()=>{I.dispose()})),(o,u)=>{const c=t,f=a,m=l,z=s,$=i,M=n;return p(),v("div",{class:"wrapper",style:w({borderImageSource:"url("+g(T)+")"})},[h($,{class:"total"},{default:y((()=>[h(z,{span:8},{default:y((()=>[h(m,{value:g(C)},{title:y((()=>[_("div",U,[b(" 专注总次数 "),h(f,{effect:"dark",content:"我专注了的次数",placement:"top"},{default:y((()=>[h(c,{style:{"margin-left":"1vw"},size:"3.5vw"},{default:y((()=>[h(g(e))])),_:1},8,["size"])])),_:1})])])),suffix:y((()=>[b("次")])),_:1},8,["value"])])),_:1}),h(z,{span:8},{default:y((()=>[h(m,{value:g(B),formatter:d},{title:y((()=>[_("div",F,[b(" 专注总时长 "),h(f,{effect:"dark",content:"我所有专注记录的总时长",placement:"top"},{default:y((()=>[h(c,{style:{"margin-left":"1vw"},size:"3.5vw"},{default:y((()=>[h(g(e))])),_:1},8,["size"])])),_:1})])])),_:1},8,["value"])])),_:1}),h(z,{span:8},{default:y((()=>[h(m,{value:g(G)},{title:y((()=>[R])),suffix:y((()=>[b("天")])),_:1},8,["value"])])),_:1})])),_:1}),_("div",V,[Z,h(M,{"border-style":"dashed"}),h($,null,{default:y((()=>[h(z,{span:12},{default:y((()=>[h(m,{value:g(W),formatter:d},{title:y((()=>[q])),_:1},8,["value"])])),_:1}),h(z,{span:12},{default:y((()=>[h(m,{value:g(H)},{title:y((()=>[J])),suffix:y((()=>[b("次")])),_:1},8,["value"])])),_:1})])),_:1})]),_("div",K,[N,Q,h(M,{"border-style":"dashed"}),(p(),x(S,null,[_("div",{class:"pie",ref_key:"pie",ref:r,style:{width:"100%",height:"56vh"}},null,512)],1024))])],4)}}},[["__scopeId","data-v-cd673ac2"]]),Y={__name:"fourthView",setup:e=>(e,t)=>(p(),x(X))};export{Y as default};
